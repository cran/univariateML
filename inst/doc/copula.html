<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Copula Modeling</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Copula Modeling</h1>



<p>This vignette shows how to model multivariate distributions with <a href="https://en.wikipedia.org/wiki/Copula_(probability_theory)">copulas</a>
using <code>univariateML</code> and the <code>copula</code> package.</p>
<p>A <strong>copula</strong> is a function describing the dependency
among a set of one-dimensional distributions. If both the marginal
distributions and the copula is known, the entire multivariate
distribution is known too.</p>
<p>Suppose we look at a multivariate distribution as the pair of a
copula and its marginals. Then a natural model selection method is
to</p>
<ol style="list-style-type: decimal">
<li>Select the marginal distributions using the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a>.</li>
<li>Select a copula using the marginal data transformed to the unit
interval, again using the AIC.</li>
</ol>
<p>This two-step procedure is commonly used due to its simplicity. The
procedure must be carried out this order since the marginal data cannot
be transformed to the unit interval unless we know the marginal
distributions.</p>
<p>The <code>univariateML</code> can be used for task 1, while the
<code>copula</code> package can be used to do task 2.</p>
<div id="abalone-data" class="section level2">
<h2>Abalone data</h2>
<p>The <code>abalone</code> data set is included in this package. It
consists of <span class="math inline">\(9\)</span> physical measurements
of <span class="math inline">\(4177\)</span> sea snails.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;univariateML&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">head</span>(abalone)</span></code></pre></div>
<pre><code>##   sex length diameter height whole_weight shucked_weight viscera_weight
## 1   M  0.455    0.365  0.095       0.5140         0.2245         0.1010
## 2   M  0.350    0.265  0.090       0.2255         0.0995         0.0485
## 3   F  0.530    0.420  0.135       0.6770         0.2565         0.1415
## 4   M  0.440    0.365  0.125       0.5160         0.2155         0.1140
## 5   I  0.330    0.255  0.080       0.2050         0.0895         0.0395
## 6   I  0.425    0.300  0.095       0.3515         0.1410         0.0775
##   shell_weight rings
## 1        0.150    15
## 2        0.070     7
## 3        0.210     9
## 4        0.155    10
## 5        0.055     7
## 6        0.120     8</code></pre>
<p>Following <span class="citation">Ko, Hjort, and Hobæk Haff
(2019)</span> we will take a look at four measurements of the abalones,
namely <code>diameter</code>, <code>height</code>,
<code>shell_weight</code> and <code>age</code>. The variable
<code>age</code> is not present in the <code>abalone</code> data, but is
defined as <code>age = rings + 1.5</code>. Moreover, there are two
outliers in the <code>height</code> data at at <span class="math inline">\(1.13\)</span> and <span class="math inline">\(0.52\)</span>. We will remove these outliers and
all columns we don’t need in the following.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(abalone, height <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>data<span class="sc">$</span>age <span class="ot">&lt;-</span> data<span class="sc">$</span>rings <span class="sc">+</span> <span class="fl">1.5</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">c</span>(<span class="st">&quot;diameter&quot;</span>, <span class="st">&quot;height&quot;</span>, <span class="st">&quot;shell_weight&quot;</span>, <span class="st">&quot;age&quot;</span>)]</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>height, <span class="at">main =</span> <span class="st">&quot;Abalone height&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Height in mm&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let’s continue doing step 1. First we must decide on a set of models
to try out.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="st">&quot;gumbel&quot;</span>, <span class="st">&quot;laplace&quot;</span>, <span class="st">&quot;logis&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;exp&quot;</span>, <span class="st">&quot;gamma&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="st">&quot;invgamma&quot;</span>, <span class="st">&quot;invgauss&quot;</span>, <span class="st">&quot;invweibull&quot;</span>, <span class="st">&quot;llogis&quot;</span>, <span class="st">&quot;lnorm&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="st">&quot;rayleigh&quot;</span>, <span class="st">&quot;weibull&quot;</span>, <span class="st">&quot;lgamma&quot;</span>, <span class="st">&quot;pareto&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;kumar&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="st">&quot;logitnorm&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">length</span>(models)</span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<p>Optionally, we can use all implemented models with</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>univariateML_models</span></code></pre></div>
<pre><code>##  [1] &quot;beta&quot;       &quot;betapr&quot;     &quot;binom&quot;      &quot;burr&quot;       &quot;cauchy&quot;    
##  [6] &quot;dunif&quot;      &quot;exp&quot;        &quot;fatigue&quot;    &quot;gamma&quot;      &quot;ged&quot;       
## [11] &quot;geom&quot;       &quot;gompertz&quot;   &quot;gumbel&quot;     &quot;invburr&quot;    &quot;invgamma&quot;  
## [16] &quot;invgauss&quot;   &quot;invweibull&quot; &quot;kumar&quot;      &quot;laplace&quot;    &quot;lgamma&quot;    
## [21] &quot;lgser&quot;      &quot;llogis&quot;     &quot;lnorm&quot;      &quot;logis&quot;      &quot;logitnorm&quot; 
## [26] &quot;lomax&quot;      &quot;naka&quot;       &quot;nbinom&quot;     &quot;norm&quot;       &quot;paralogis&quot; 
## [31] &quot;pareto&quot;     &quot;pois&quot;       &quot;power&quot;      &quot;rayleigh&quot;   &quot;sged&quot;      
## [36] &quot;snorm&quot;      &quot;sstd&quot;       &quot;std&quot;        &quot;unif&quot;       &quot;weibull&quot;   
## [41] &quot;zip&quot;        &quot;zipf&quot;</code></pre>
<p>The next step is to fit all models, compute the AIC, and select the
best model. This is exactly what <code>model_select()</code> does.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>margin_fits <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data, model_select, <span class="at">models =</span> models, <span class="at">criterion =</span> <span class="st">&quot;aic&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: intervals</code></pre>
<p>Now we use the <code>fitCopula</code> from the package
<code>copula</code> on the transformed margins of
<code>abalone</code>.</p>
<p>We will examine two elliptical copulas and three Archimedean copulas.
The elliptical copulas are the Gaussian copula and the
<em>t</em>-copula, while the Archimedean copulas are the Joe copula, the
Clayton copula, and the Gumbel copula.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Transform the marginals to the unit interval.</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_along</span>(data), <span class="cf">function</span>(j) <span class="fu">pml</span>(data[[j]], margin_fits[[j]]))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># The copulas described above.</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>copulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">normal =</span> copula<span class="sc">::</span><span class="fu">normalCopula</span>(<span class="at">dim =</span> <span class="dv">4</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>),</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">t =</span> copula<span class="sc">::</span><span class="fu">tCopula</span>(<span class="at">dim =</span> <span class="dv">4</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">joe =</span> copula<span class="sc">::</span><span class="fu">joeCopula</span>(<span class="at">dim =</span> <span class="dv">4</span>),</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">clayton =</span> copula<span class="sc">::</span><span class="fu">claytonCopula</span>(<span class="at">dim =</span> <span class="dv">4</span>),</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="at">gumbel =</span> copula<span class="sc">::</span><span class="fu">gumbelCopula</span>(<span class="at">dim =</span> <span class="dv">4</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  copulas,</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="cf">function</span>(x) copula<span class="sc">::</span><span class="fu">fitCopula</span>(x, <span class="at">data =</span> y, <span class="at">method =</span> <span class="st">&quot;mpl&quot;</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="fu">sapply</span>(fits, AIC)</span></code></pre></div>
<pre><code>##     normal          t        joe    clayton     gumbel 
## -21822.309 -23152.657  -8668.457 -16502.422 -12821.817</code></pre>
<p>The <em>t</em>-copula is the clear winner of the AIC competition. The
Archimedean copulas perform particularly poorly.</p>
<p>Hence our final model is the <em>t</em>-copula with Kumaraswamy
(<code>mlkumar</code>) marginal distribution for <code>diameter</code>,
normal marginal distribution for <code>height</code>, Weibull marginal
distribution for <code>shell_weight</code>, and log normal marginal
distribution for <code>age</code>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ko2019focused" class="csl-entry">
Ko, Vinnie, Nils Lid Hjort, and Ingrid Hobæk Haff. 2019. <span>“Focused
Information Criteria for Copulas.”</span> <em>Scandinavian Journal of
Statistics</em>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
